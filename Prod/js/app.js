"use strict";window.onload=function(){var a=new Instance;a.Init()},function(){function a(a){this.range=a.range,this.seed=a.seed,this.loops=a.loops,this.smoothLoops=a.smoothLoops}a.prototype.New=function(){for(var a=this.NewSeed(),b=0;b<this.loops;b++)a=this.Split(a);for(var b=0;b<this.smoothLoops;b++)a=this.smooth(a);return a},a.prototype.NewSeed=function(){for(var a=[],b=0;b<this.seed.height;b++){a[b]=[];for(var c=0;c<this.seed.width;c++)a[b][c]=Math.floor(Math.random()*this.range)}return a},a.prototype.Split=function(a){return a=this.Horizontal(a),a=this.Vertical(a)},a.prototype.NewTile=function(a,b){var c=b>=a?a:b,d=a>=b?a:b,e=d-c<this.range?d-c+1:this.range,f=Math.floor(Math.random()*e)+c;return f>=0?f:0},a.prototype.Horizontal=function(a){for(var b=[],c=0;c<a.length;c++){b[c]=[];for(var d=0;d<a[c].length;d++)b[c].push(a[c][d]),b[c].push(this.addHorizontal(a,c,d))}return b},a.prototype.addHorizontal=function(a,b,c){var d=0;d=void 0!=a[b][c-1]&&void 0!=a[b][c+1]?parseInt((a[b][c-1]+a[b][c+1])/2):void 0!=a[b][c-1]?a[b][c-1]:a[b][c+1];var e=0;return e=void 0!=a[b-1]&&void 0!=a[b+1]?parseInt((a[b-1][c]+a[b+1][c])/2):void 0!=a[b-1]?a[b-1][c]:a[b+1][c],this.NewTile(d,e)},a.prototype.Vertical=function(a){for(var b=[],c=0;c<a.length;c++){b[2*c]=a[c],b[2*c+1]=[];for(var d=0;d<a[c].length;d++)b[2*c+1].push(this.addVertical(a,c,d))}return b},a.prototype.addVertical=function(a,b,c){var d=[];void 0!=a[b]&&(void 0!=a[b][c-1]&&d.push(a[b][c-1]),void 0!=a[b][c+1]&&d.push(a[b][c+1])),void 0!=a[b+1]&&(void 0!=a[b+1][c-1]&&d.push(a[b+1][c-1]),void 0!=a[b+1][c+1]&&d.push(a[b+1][c+1]));var e=this.parseVertical(d),f=0;return f=void 0!=a[b-1]&&void 0!=a[b+1]?parseInt((a[b-1][c]+a[b+1][c])/2):void 0!=a[b-1]?a[b-1][c]:a[b+1][c],this.NewTile(e,f)},a.prototype.parseVertical=function(a){return 1==a.length?parseInt(a[0]):2==a.length?parseInt((a[0]+a[1])/2):4==a.length?parseInt((a[0]+a[1]+a[2]+a[3])/2):0},a.prototype.smooth=function(a){for(var b=[],c=0;c<a.length;c++){b[c]=[];for(var d=0;d<a[c].length;d++)b[c][d]=this.smoothX(a,c,d)}for(var c=0;c<b.length;c++)for(var d=0;d<b[c].length;d++)b[c][d]=this.smoothO(b,c,d);return b},a.prototype.smoothX=function(a,b,c){var d=[],e=0;void 0!=a[b-1]&&(void 0!=a[b-1][c-1]&&d.push(a[b-1][c-1]),void 0!=a[b-1][c+1]&&d.push(a[b-1][c+1])),d.push(a[b][c]),void 0!=a[b+1]&&(void 0!=a[b+1][c-1]&&d.push(a[b+1][c-1]),void 0!=a[b+1][c+1]&&d.push(a[b+1][c+1]));for(var b in d)e+=parseInt(d[b]);return parseInt(e/d.length)},a.prototype.smoothO=function(a,b,c){var d=[],e=0;void 0!=a[b-1]&&d.push(a[b-1][c]),void 0!=a[b][c-1]&&d.push(a[b][c-1]),void 0!=a[b][c+1]&&d.push(a[b][c+1]),void 0!=a[b+1]&&d.push(a[b+1][c]);for(var b in d)e+=parseInt(d[b]);return parseInt(e/d.length)},window.Generator=a}(),function(){function a(){this.data=[],this.canvas={dom:document.getElementById("world"),context:document.getElementById("world").getContext("2d")},this.map={grid:20,seed:{width:15,height:20},range:12,loops:4,smoothLoops:2}}a.prototype.Init=function(){this.generator=new Generator(this.map),this.render=new Render(this.canvas,this.grid,this.map),this.data=this.generator.New();var a=this;window.onresize=function(){a.render.draw(a.data)},this.render.draw(this.data)},window.Instance=a}(),function(){function a(a,b,c){this.canvas=a,this.grid=b,this.map=c,this.color=["#14142b","#21213d","#2b2b4a","#303056","#3D3D69","#5B66A7","#7784CF","#CBB361","#81BA84","#49A34d","#469A47","#408d3E","#346E29","#346E29","#6B5629","#6B5629","#564D39","#4D4D48","#7E7F82","#C4C4C4"]}a.prototype.draw=function(a){this.level=0,this.canvas.dom.width=window.innerWidth,this.canvas.dom.height=window.innerHeight;var b=document.createElement("canvas"),c=b.getContext("2d");b.width=window.innerWidth*window.devicePixelRatio,b.height=window.innerHeight*window.devicePixelRatio;for(var d=0;d<this.color.length;d++){var e=this.generateBlock(d);7==d&&(c.fillStyle="rgba(48, 65, 107, 0.8);",c.beginPath(),c.rect(0,0,b.width,b.height),c.fill());for(var f in a)for(var g in a[f])a[f][g]==d&&this.placeBlock(c,f,g,d,e)}this.canvas.context.drawImage(b,0,0,b.width/window.devicePixelRatio,b.height/window.devicePixelRatio)},a.prototype.generateBlock=function(a){var b=this.map.grid*window.devicePixelRatio,c=document.createElement("canvas"),d=c.getContext("2d");return c.width=b*window.devicePixelRatio,c.height=1.5*b*window.devicePixelRatio,7==a?this.drawHalfBlock(d,b/2,0,a):this.drawFullBlock(d,b/2,0,a),c},a.prototype.drawFullBlock=function(a,b,c,d){var e=this.map.grid*window.devicePixelRatio;a.fillStyle=this.color[d],a.strokeStyle=this.color[d],a.beginPath(),a.moveTo(c+e/2,b-e/2),a.lineTo(c+e,b),a.lineTo(c+e/2,b+e/2),a.lineTo(c,b),a.lineTo(c+e/2,b-e/2),a.closePath(),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d],-.2),a.strokeStyle=this.shadeColor(this.color[d],-.3),a.beginPath(),a.moveTo(c,b),a.lineTo(c+e/2,b+e/2),a.lineTo(c+e/2,b+e),a.lineTo(c,b+e/2),a.lineTo(c,b),a.closePath(),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d],-.4),a.strokeStyle=this.shadeColor(this.color[d],-.5),a.beginPath(),a.moveTo(c+e/2,b+e/2),a.lineTo(c+e/2,b+e),a.lineTo(c+e,b+e/2),a.lineTo(c+e,b),a.lineTo(c+e/2,b+e/2),a.closePath(),a.fill(),a.stroke()},a.prototype.drawHalfBlock=function(a,b,c,d){var e=this.map.grid*window.devicePixelRatio;a.fillStyle=this.color[d],a.strokeStyle=this.color[d],a.beginPath(),a.moveTo(c+e/2,b-e/2),a.lineTo(c+e,b),a.lineTo(c+e/2,b+e/2),a.lineTo(c,b),a.lineTo(c+e/2,b-e/2),a.closePath(),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d],-.2),a.strokeStyle=this.shadeColor(this.color[d],-.35),a.beginPath(),a.moveTo(c,b),a.lineTo(c+e/2,b+e/2),a.lineTo(c+e/2,b+.75*e),a.lineTo(c,b+.25*e),a.lineTo(c,b),a.closePath(),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d-1],-.35),a.strokeStyle=this.shadeColor(this.color[d-1],-.4),a.beginPath(),a.moveTo(c,b+.25*e),a.lineTo(c+e/2,b+.75*e),a.lineTo(c+e/2,b+e),a.lineTo(c,b+.5*e),a.lineTo(c,b+.25*e),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d],-.4),a.strokeStyle=this.shadeColor(this.color[d],-.45),a.beginPath(),a.moveTo(c+e/2,b+e/2),a.lineTo(c+e/2,b+.75*e),a.lineTo(c+e,b+.25*e),a.lineTo(c+e,b),a.lineTo(c+e/2,b+e/2),a.closePath(),a.fill(),a.stroke(),a.fillStyle=this.shadeColor(this.color[d-1],-.5),a.strokeStyle=this.shadeColor(this.color[d-1],-.55),a.beginPath(),a.moveTo(c+e,b+.25*e),a.lineTo(c+e/2,b+.75*e),a.lineTo(c+e/2,b+e),a.lineTo(c+e,b+.5*e),a.lineTo(c+e,b+.25*e),a.closePath(),a.fill(),a.stroke()},a.prototype.placeBlock=function(a,b,c,d,e){var f=this.map.grid*window.devicePixelRatio;c=f*c+b%2*(f/2),b=f*(b/2)-d*(f/2)+0*f,c-=f/2,b-=f/2,a.drawImage(e,c,b)},a.prototype.shadeColor=function(a,b){var c=parseInt(a.slice(1),16),d=0>b?0:255,e=0>b?-1*b:b,f=c>>16,g=c>>8&255,h=255&c;return"#"+(16777216+65536*(Math.round((d-f)*e)+f)+256*(Math.round((d-g)*e)+g)+(Math.round((d-h)*e)+h)).toString(16).slice(1)},window.Render=a}();